<!DOCTYPE html>
<html ng-app="module" ng-controller="controller" lang="en">
<head>
    <title>Music Transfer</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/png" href="res/icon.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="src/style.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.3/angular-sanitize.min.js"></script>
    <script type="module" src="src/controller.js"></script>
</head>
<body class="d-flex flex-column align-items-center m-4">
<header class="text-center">
    <h1 class="fs-1 fw-bold">
        Music Transfer
    </h1>
    <h2 class="fs-5 fw-light text-decoration-underline">
        Transfer saved playlists, tracks, albums, and artists across streaming platforms!
    </h2>
</header>
<main class="w-100 d-flex flex-column gap-4 my-4" style="max-width: 1200px">
    <div class="d-flex flex-column flex-md-row gap-1 gap-md-3 align-items-md-center">
        <label for="source" class="text-nowrap">
            <span class="fw-bolder">1.</span> Select your <span class="text-emphasize">source</span> service:
        </label>
        <select id="source"
                class="w-100 small"
                style="padding: 2px 6px"
                ng-model="choices.source"
                ng-change="authorize('source')"
                ng-options="s as s.name disable when s.disabled for s in services">
        </select>
    </div>
    <div class="d-flex flex-column flex-md-row gap-1 gap-md-3 align-items-md-center" ng-if="choices.source.token()">
        <label for="target" class="text-nowrap">
            <span class="fw-bolder">2.</span> Select your <span class="text-emphasize">target</span> service:
        </label>
        <select id="target"
                class="w-100 small"
                style="padding: 2px 6px"
                ng-model="choices.target"
                ng-change="authorize('target')"
                ng-options="s as s.name disable when (s.disabled || s.name === choices.source.name) for s in services">
        </select>
    </div>
    <div ng-if="choices.transfer" class="d-flex flex-column gap-2">
        <label for="transfer">
            <span class="fw-bolder">3.</span> Select the data you want to <span class="text-emphasize">transfer</span>:
        </label>
        <select id="transfer"
                class="w-100 small"
                style="padding: 2px 6px"
                ng-model="choices.transfer"
                ng-change="choices.transfer.fetch()"
                ng-options="item for item in results">
        </select>
        <div class="row buttons">
            <button class="col text-decoration-underline ms-3"
                    ng-disabled="!choices.transfer.ready()"
                    ng-click="selection(true)">
                Select All
            </button>
            <button class="col text-decoration-underline mx-2"
                    ng-disabled="!choices.transfer.ready()"
                    ng-click="selection(false)">
                Deselect All
            </button>
            <button class="col text-decoration-underline text-capitalize me-3"
                    ng-disabled="!choices.transfer.ready()"
                    ng-click="transfer()">
                {{choices.transfer.ready() ? "Transfer" : choices.transfer.items.length + "/" + choices.transfer.size}}
            </button>
        </div>
        <div class="d-grid small items">
            <div ng-repeat="item in choices.transfer.items"
                 class="d-flex flex-row flex-lg-row align-items-center gap-2 mx-3 my-1"
                 ng-class="{'flex-md-row-reverse': $odd}">
                <input type="checkbox" id="{{key}}-{{item.id}}" ng-model="item.selected"/>
                <label for="{{key}}-{{item.id}}"
                       class="{{item.selected ? 'fw-bold' : 'text-decoration-line-through'}}">
                    {{item}}
                </label>
            </div>
        </div>
    </div>
    <div ng-if="error" class="alert alert-danger" role="alert">
        The server responded with an error, please try again...
    </div>
</main>

{{choices.transfer.items.length}}
{{choices.transfer.size}}

</body>
</html>